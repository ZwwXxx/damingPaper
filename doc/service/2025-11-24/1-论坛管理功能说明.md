# 论坛管理功能说明文档

## 一、功能概述

本次开发完成了论坛管理后台功能，包括帖子管理和评论管理两大模块。管理员可以对用户发布的帖子和评论进行管理、审核、删除等操作。

## 二、功能模块

### 1. 帖子管理
- **列表查询**：支持按标题、发帖人、状态、置顶、热门等条件筛选
- **查看详情**：查看帖子完整信息，包括内容、图片、统计数据等
- **置顶/取消置顶**：设置帖子是否在首页置顶显示
- **热门/取消热门**：标记帖子为热门帖子
- **删除帖子**：逻辑删除帖子（status设为0）
- **批量删除**：支持批量删除多个帖子
- **导出数据**：导出帖子列表为Excel文件

### 2. 评论管理
- **列表查询**：支持按帖子ID、评论人、内容、状态等条件筛选
- **查看详情**：查看评论完整信息，包括回复关系
- **删除评论**：逻辑删除评论及其子评论
- **批量删除**：支持批量删除多个评论
- **导出数据**：导出评论列表为Excel文件

## 三、技术实现

### 前端文件结构
```
daming-admin/ruoyi-ui/src/
├── api/quiz/
│   └── forum.js                    # 论坛管理API接口
└── views/quiz/forum/
    ├── post/
    │   └── index.vue              # 帖子管理页面
    └── comment/
        └── index.vue              # 评论管理页面
```

### 后端文件结构
```
daming-admin/
├── ruoyi-admin/src/main/java/com/ruoyi/web/controller/quiz/
│   └── ForumAdminController.java  # 论坛管理控制器
└── dm_questionBank/src/main/java/com/ruoyi/quiz/
    ├── service/
    │   ├── IForumService.java     # 论坛服务接口（新增管理方法）
    │   └── impl/
    │       └── ForumServiceImpl.java  # 论坛服务实现（新增管理方法）
    ├── mapper/
    │   ├── ForumPostMapper.java   # 帖子Mapper接口（新增管理方法）
    │   └── ForumCommentMapper.java # 评论Mapper接口
    └── resources/mapper/quiz/
        └── ForumPostMapper.xml    # 帖子SQL映射（新增SQL语句）
```

### API接口

#### 帖子管理接口
- `GET /quiz/admin/forum/post/list` - 查询帖子列表
- `GET /quiz/admin/forum/post/{postId}` - 查询帖子详情
- `DELETE /quiz/admin/forum/post/{postIds}` - 删除帖子
- `PUT /quiz/admin/forum/post/top` - 置顶/取消置顶
- `PUT /quiz/admin/forum/post/hot` - 热门/取消热门
- `PUT /quiz/admin/forum/post/audit` - 审核帖子
- `POST /quiz/admin/forum/post/export` - 导出帖子列表

#### 评论管理接口
- `GET /quiz/admin/forum/comment/list` - 查询评论列表
- `GET /quiz/admin/forum/comment/{commentId}` - 查询评论详情
- `DELETE /quiz/admin/forum/comment/{commentIds}` - 删除评论
- `POST /quiz/admin/forum/comment/export` - 导出评论列表

## 四、数据库设计

### 帖子表 (forum_post)
```sql
-- 已存在，新增字段说明：
is_top INT DEFAULT 0 COMMENT '是否置顶(0否 1是)'
is_hot INT DEFAULT 0 COMMENT '是否热门(0否 1是)'
status INT DEFAULT 1 COMMENT '状态(0删除 1正常 2审核中)'
```

### 评论表 (forum_comment)
```sql
-- 已存在，状态字段说明：
status INT DEFAULT 1 COMMENT '状态(0删除 1正常)'
```

## 五、权限配置

### 需要在系统管理-菜单管理中添加以下菜单：

#### 1. 论坛管理（父菜单）
- 菜单名称：论坛管理
- 路由地址：forum
- 菜单类型：目录
- 菜单图标：message
- 显示排序：5

#### 2. 帖子管理（子菜单）
- 菜单名称：帖子管理
- 路由地址：post
- 组件路径：quiz/forum/post/index
- 菜单类型：菜单
- 权限字符：quiz:forum:list

#### 3. 评论管理（子菜单）
- 菜单名称：评论管理
- 路由地址：comment
- 组件路径：quiz/forum/comment/index
- 菜单类型：菜单
- 权限字符：quiz:forum:list

### 权限标识说明
- `quiz:forum:list` - 查看论坛数据
- `quiz:forum:query` - 查询论坛详情
- `quiz:forum:edit` - 编辑论坛数据（置顶、热门、审核）
- `quiz:forum:remove` - 删除论坛数据
- `quiz:forum:export` - 导出论坛数据

## 六、使用说明

### 帖子管理操作流程

1. **查询帖子**
   - 进入"论坛管理-帖子管理"页面
   - 使用搜索条件筛选（标题、发帖人、状态等）
   - 点击"搜索"按钮

2. **查看详情**
   - 点击操作列的"查看"按钮
   - 弹出对话框显示帖子完整信息

3. **置顶帖子**
   - 点击操作列的"置顶"/"取消置顶"按钮
   - 确认操作

4. **设置热门**
   - 点击操作列的"热门"/"取消热门"按钮
   - 确认操作

5. **删除帖子**
   - 单个删除：点击操作列的"删除"按钮
   - 批量删除：勾选多个帖子后，点击顶部"删除"按钮
   - 确认删除操作

6. **导出数据**
   - 设置筛选条件（可选）
   - 点击"导出"按钮
   - 下载Excel文件

### 评论管理操作流程

1. **查询评论**
   - 进入"论坛管理-评论管理"页面
   - 使用搜索条件筛选（帖子ID、评论人、内容等）
   - 点击"搜索"按钮

2. **查看详情**
   - 点击操作列的"查看"按钮
   - 弹出对话框显示评论完整信息

3. **删除评论**
   - 单个删除：点击操作列的"删除"按钮
   - 批量删除：勾选多个评论后，点击顶部"删除"按钮
   - 确认删除操作（会同时删除该评论的所有子评论）

4. **导出数据**
   - 设置筛选条件（可选）
   - 点击"导出"按钮
   - 下载Excel文件

## 七、注意事项

1. **删除操作**：所有删除操作均为逻辑删除，不会物理删除数据，只是将status字段设为0
2. **级联删除**：删除帖子时会自动删除该帖子的所有评论和点赞记录
3. **评论树**：删除父评论时会递归删除所有子评论
4. **权限控制**：所有管理接口都需要相应的权限才能访问
5. **数据导出**：导出功能会根据当前筛选条件导出数据

## 八、后续优化建议

1. **批量审核**：添加批量审核功能，提高管理效率
2. **统计报表**：添加论坛数据统计图表
3. **敏感词过滤**：集成敏感词过滤系统
4. **自动审核**：基于规则的自动审核机制
5. **举报管理**：添加用户举报功能和举报管理页面
6. **内容审核**：集成AI内容审核接口

## 九、开发人员

- 开发时间：2025-11-24
- 开发人员：Cascade AI
- 版本：v1.0.0
