<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.quiz.mapper.ForumLikeMapper">
    
    <resultMap type="com.ruoyi.common.core.domain.entity.ForumLike" id="ForumLikeResult">
        <id     property="likeId"      column="like_id"      />
        <result property="userId"      column="user_id"      />
        <result property="targetId"    column="target_id"    />
        <result property="targetType"  column="target_type"  />
        <result property="createTime"  column="create_time"  />
    </resultMap>

    <insert id="insertForumLike" parameterType="com.ruoyi.common.core.domain.entity.ForumLike">
        insert into forum_like (user_id, target_id, target_type)
        values (#{userId}, #{targetId}, #{targetType})
    </insert>

    <delete id="deleteForumLike">
        delete from forum_like 
        where user_id = #{userId} 
          and target_id = #{targetId} 
          and target_type = #{targetType}
    </delete>

    <select id="checkLikeExists" resultType="int">
        select count(*) from forum_like
        where user_id = #{userId} 
          and target_id = #{targetId} 
          and target_type = #{targetType}
    </select>

    <select id="batchCheckLikeExists" resultType="Long">
        select target_id from forum_like
        where user_id = #{userId} 
          and target_type = #{targetType}
          and target_id in
        <foreach item="id" collection="targetIds" open="(" separator="," close=")">
            #{id}
        </foreach>
    </select>

    <delete id="deleteLikesByTarget">
        delete from forum_like 
        where target_id = #{targetId} 
          and target_type = #{targetType}
    </delete>

</mapper>
